openapi: 3.0.0
info:
  title: Movie Backend API
  description: |
    API documentation cho ứng dụng Movie Backend

    **🔄 PHIÊN BẢN ĐÃ CẬP NHẬT:**
    - ❌ Đã bỏ JWT tokens  
    - ❌ Đã bỏ authentication middleware
    - ✅ Sử dụng userId đơn giản

    **📋 FLOW AUTH MỚI (1 màn hình duy nhất):**
    1. **Màn hình nhập SĐT:** User nhập số điện thoại
    2. **Hệ thống check:** 
       - Nếu SĐT đã đăng ký → Gửi OTP đăng nhập → Verify → Vào trang chủ
       - Nếu SĐT chưa đăng ký → Gửi OTP đăng ký → Verify → Nhập thông tin → Vào trang chủ
    3. **Lưu userId:** Store trong AsyncStorage/localStorage để dùng cho các API khác

    **📱 CÁC BƯỚC THỰC HIỆN:**
    1. Gọi `/api/auth/send-otp` với số điện thoại
    2. Gọi `/api/auth/verify-otp` để xác thực
    3. Nếu response có `needsRegistration: true` → Gọi `/api/auth/complete-registration`
    4. Nếu response có `needsRegistration: false` → Đăng nhập thành công, vào trang chủ

    **📁 AWS S3 CONFIGURATION:**
    - **Bucket:** locdev-bucket (ap-southeast-1)
    - **Avatar path:** assets/avatar-users/{uuid}.{extension}
    - **Supported formats:** JPEG, PNG, GIF
    - **Max file size:** 2MB
    - **Auto cleanup:** Old avatars deleted when uploading new ones

    **🎯 PROFILE UPDATE API:**
    - **Endpoint:** PUT `/api/users/profile?userId={id}`
    - **Content-Type:** multipart/form-data
    - **Fields:** full_name, gender, avatar (file)
    - **Integration:** Direct S3 upload + MongoDB update
  version: 1.2.0
  contact:
    email: your-email@example.com

servers:
  - url: http://localhost:3003
    description: Development server
  - url: https://backend-app-lou3.onrender.com
    description: Production server

tags:
  - name: Authentication
    description: Các API liên quan đến xác thực người dùng (/api/auth) - Trả về userId
  - name: User
    description: Các API liên quan đến thông tin người dùng (/api/users) - Cần userId
  - name: Movie
    description: Các API liên quan đến phim (/api/movies)
  - name: Episode
    description: Các API liên quan đến tập phim (/api/episodes)
  - name: Favorite
    description: Các API liên quan đến danh sách yêu thích (/api/favorites) - Cần userId
  - name: Payment
    description: Các API liên quan đến thanh toán (/api/payments) - Cần userId
  - name: Rating
    description: Các API liên quan đến đánh giá (/api/ratings) - Cần userId
  - name: Genre
    description: Các API liên quan đến thể loại phim (/api/genres)
  - name: Home
    description: Các API trang chủ (/api/home) - Banner, phim mới, đề xuất
  - name: Series
    description: Các API cho phim bộ/series (/api/series) - Banner, trending, phân loại theo quốc gia

paths:
  # === FLOW MỚI: 1 MÀN HÌNH DUY NHẤT ===
  /api/auth/send-otp:
    post:
      tags:
        - Authentication
      summary: 🔄 Gửi mã OTP (Đăng ký/Đăng nhập thống nhất)
      description: |
        **🔄 FLOW MỚI:** Gửi mã OTP cho cả đăng ký và đăng nhập trong 1 API duy nhất.

        **Logic xử lý:**
        - Nếu số điện thoại đã tồn tại → Gửi OTP đăng nhập
        - Nếu số điện thoại chưa tồn tại → Gửi OTP đăng ký
        - Frontend không cần biết user đã đăng ký hay chưa

        **Đặc điểm:**
        - Mã OTP có 6 số, gửi qua SMS
        - OTP có thời hạn (thường 5 phút)
        - Rate limiting: Tối đa 3 lần/phút
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/PhoneRequest"
      responses:
        "200":
          description: Gửi OTP thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã gửi mã OTP"
                  data:
                    type: object
                    properties:
                      phone:
                        type: string
                        example: "0912345678"
                      isExistingUser:
                        type: boolean
                        example: true
                        description: "true = user đã đăng ký (đăng nhập), false = user mới (đăng ký)"
              example:
                status: "success"
                message: "Đã gửi mã OTP đăng nhập"
                data:
                  phone: "0912345678"
                  isExistingUser: true
        "400":
          description: Lỗi validate số điện thoại
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/auth/verify-otp:
    post:
      tags:
        - Authentication
      summary: 🔄 Xác thực OTP (Đăng ký/Đăng nhập thống nhất)
      description: |
        **🔄 FLOW MỚI:** Xác thực mã OTP cho cả đăng ký và đăng nhập.

        **Response paths:**
        1. **User đã đăng ký:** `needsRegistration: false` → Frontend vào trang chủ
        2. **User chưa đăng ký:** `needsRegistration: true` → Frontend chuyển màn hình nhập thông tin
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/VerifyOTPRequest"
      responses:
        "200":
          description: Xác thực OTP thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Xác thực OTP thành công"
                  data:
                    type: object
                    properties:
                      needsRegistration:
                        type: boolean
                        example: false
                        description: "false = đăng nhập thành công, true = cần nhập thông tin đăng ký"
                      userId:
                        type: string
                        example: "683d7b63d0ee4aeb15a11369"
                        description: "Chỉ có khi needsRegistration = false"
                      user:
                        $ref: "#/components/schemas/UserInfo"
                        description: "Chỉ có khi needsRegistration = false"
              examples:
                existing_user:
                  summary: User đã đăng ký (đăng nhập thành công)
                  value:
                    status: "success"
                    message: "Đăng nhập thành công"
                    data:
                      needsRegistration: false
                      userId: "683d7b63d0ee4aeb15a11369"
                      user:
                        _id: "683d7b63d0ee4aeb15a11369"
                        uid: "683d7b63d0ee4aeb15a11369"
                        full_name: "Nguyễn Văn A"
                        email: "example@gmail.com"
                        phone: "0912345678"
                        gender: "male"
                        avatar: "https://example.com/avatar.jpg"
                        is_phone_verified: true
                new_user:
                  summary: User chưa đăng ký (cần nhập thông tin)
                  value:
                    status: "success"
                    message: "Xác thực OTP thành công, vui lòng nhập thông tin"
                    data:
                      needsRegistration: true
        "400":
          description: Mã OTP không hợp lệ hoặc đã hết hạn
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/auth/complete-registration:
    post:
      tags:
        - Authentication
      summary: 🔄 Hoàn tất đăng ký (Sau khi verify OTP)
      description: |
        **🔄 FLOW MỚI:** Hoàn tất quá trình đăng ký sau khi verify OTP thành công.

        **Khi nào sử dụng:**
        - Khi `/api/auth/verify-otp` trả về `needsRegistration: true`
        - User đã xác thực số điện thoại, giờ cần nhập thông tin cá nhân

        **⚠️ QUAN TRỌNG:**
        - Không cần truyền phone, hệ thống tự động lấy từ OTP record đã verify
        - Phải gọi trong vòng 10 phút sau khi verify OTP thành công
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/RegisterRequest"
            example:
              full_name: "Nguyễn Văn A"
              email: "example@gmail.com"
              gender: "male"
      responses:
        "201":
          description: Đăng ký thành công
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/AuthResponse"
        "400":
          description: Lỗi validate dữ liệu, email đã tồn tại, hoặc phone không hợp lệ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/auth/logout:
    post:
      tags:
        - Authentication
      summary: 🔄 Đăng xuất
      description: |
        Đăng xuất người dùng (chỉ trả về success message).

        **📱 Frontend cần làm:**
        - Xóa `userId` khỏi AsyncStorage/localStorage
        - Không cần gọi API refresh token hay gì cả
      responses:
        "200":
          description: Đăng xuất thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đăng xuất thành công"

  /api/users/profile:
    get:
      tags:
        - User
      summary: Lấy thông tin profile
      description: |
        Lấy thông tin chi tiết của user.

        **🔄 THAY ĐỔI:** Không cần Bearer token, chỉ cần truyền userId qua query params
      parameters:
        - name: userId
          in: query
          required: true
          schema:
            type: string
          example: "683d7b63d0ee4aeb15a11369"
          description: "ID của user cần lấy thông tin"
      responses:
        "200":
          description: Lấy thông tin thành công
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProfileResponse"
              example:
                status: "success"
                data:
                  user:
                    _id: "683d7b63d0ee4aeb15a11369"
                    uid: "683d7b63d0ee4aeb15a11369"
                    full_name: "Nguyễn Văn A"
                    email: "example@gmail.com"
                    phone: "0912345678"
                    gender: "male"
                    avatar: "https://example.com/avatar.jpg"
                    is_phone_verified: true
        "400":
          description: Thiếu userId hoặc userId không hợp lệ
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "userId là bắt buộc"
        "404":
          description: Không tìm thấy user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Không tìm thấy user"

    put:
      tags:
        - User
      summary: 🔄 Cập nhật profile (với upload avatar)
      description: |
        **🔄 API ĐÃ CẬP NHẬT:** Hỗ trợ upload avatar trực tiếp lên AWS S3 + cập nhật thông tin profile.

        **📋 TÍNH NĂNG:**
        - ✅ Cập nhật họ tên, giới tính
        - ✅ Upload avatar lên AWS S3 (auto delete avatar cũ)
        - ✅ Validation file ảnh (JPEG, PNG, GIF, max 2MB)
        - ✅ Unified API: có thể update chỉ text hoặc chỉ avatar hoặc cả hai

        **📤 REQUEST FORMAT:**
        - **Content-Type:** `multipart/form-data` (bắt buộc)
        - **Text fields:** full_name, gender
        - **File field:** avatar (optional)

        **📁 S3 STORAGE:**
        - Path: `assets/avatar-users/{uuid}.{ext}`
        - Auto generate unique filename
        - Auto delete old avatar khi upload mới

        **⚠️ LƯU Ý:**
        - Phone, email KHÔNG thể cập nhật qua API này (readonly)
        - Avatar file: JPEG/PNG/GIF, max 2MB
        - Nếu không upload avatar → chỉ update text fields
      parameters:
        - name: userId
          in: query
          required: true
          schema:
            type: string
          example: "684269635fb34def3a1e28fd"
          description: "ID của user cần cập nhật"
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                full_name:
                  type: string
                  description: "Họ và tên người dùng"
                  example: "Đạt Thiện"
                gender:
                  type: string
                  enum: [male, female, other]
                  description: "Giới tính: male=Nam, female=Nữ, other=Khác"
                  example: "male"
                avatar:
                  type: string
                  format: binary
                  description: "File ảnh đại diện (JPEG/PNG/GIF, max 2MB)"
            encoding:
              avatar:
                contentType: image/jpeg, image/png, image/gif
            examples:
              update_text_only:
                summary: "Chỉ cập nhật text (không upload avatar)"
                value:
                  full_name: "Đạt Thiện Updated"
                  gender: "male"
              update_with_avatar:
                summary: "Cập nhật text + upload avatar"
                value:
                  full_name: "Đạt Thiện Updated"
                  gender: "male"
                  avatar: "[BINARY FILE DATA]"
      responses:
        "200":
          description: ✅ Cập nhật thành công
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ProfileResponse"
              examples:
                text_only_update:
                  summary: "Cập nhật chỉ text thành công"
                  value:
                    status: "success"
                    message: "✅ User profile updated successfully"
                    data:
                      user:
                        _id: "684269635fb34def3a1e28fd"
                        uid: "684269635fb34def3a1e28fd"
                        full_name: "Đạt Thiện Updated"
                        email: "datthien@gmail.com"
                        phone: "0288348192"
                        gender: "male"
                        avatar: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/avatar-users/old-avatar.jpg"
                        is_phone_verified: true
                avatar_upload_success:
                  summary: "Upload avatar + cập nhật text thành công"
                  value:
                    status: "success"
                    message: "✅ User profile updated successfully"
                    data:
                      user:
                        _id: "684269635fb34def3a1e28fd"
                        uid: "684269635fb34def3a1e28fd"
                        full_name: "Đạt Thiện Updated"
                        email: "datthien@gmail.com"
                        phone: "0288348192"
                        gender: "male"
                        avatar: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/avatar-users/32c5a14e-3fa0-497a-b036-32de0cdc842a.jpg"
                        is_phone_verified: true
        "400":
          description: ❌ Lỗi validation hoặc file
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              examples:
                missing_userId:
                  summary: "Thiếu userId"
                  value:
                    status: "error"
                    message: "userId là bắt buộc"
                file_too_large:
                  summary: "File quá lớn"
                  value:
                    status: "error"
                    message: "Tệp quá lớn. Chỉ cho phép tệp nhỏ hơn 2MB"
                invalid_file_type:
                  summary: "Loại file không hợp lệ"
                  value:
                    status: "error"
                    message: "Chỉ cho phép file ảnh (JPEG, PNG, GIF)"
                s3_upload_error:
                  summary: "Lỗi upload S3"
                  value:
                    status: "error"
                    message: "Lỗi khi upload file lên S3"
        "404":
          description: ❌ Không tìm thấy user
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Không tìm thấy user"
        "500":
          description: ❌ Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi server khi xử lý upload"

  /api/home/new-releases:
    get:
      tags:
        - Home
      summary: API Banner và Phim đề xuất
      description: |
        Lấy danh sách phim mới ra mắt cho Banner đầu trang và danh sách ở dưới "Phim dành cho bạn".

        **Đặc điểm:**
        - Public API (không cần đăng nhập)
        - Chỉ lấy phim có release_status = "released"
        - Sắp xếp theo ngày tạo mới nhất
        - Trả về 2 sections riêng biệt
      parameters:
        - name: bannerLimit
          in: query
          required: false
          schema:
            type: integer
            default: 5
            minimum: 1
            maximum: 10
          description: Số lượng phim trong banner list (mặc định 5)
          example: 3
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 6
            minimum: 1
            maximum: 12
          description: Số lượng phim trong grid "Phim dành cho bạn" (mặc định 6)
          example: 4
        - name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: Lấy phim mới trong X ngày gần đây (mặc định 30 ngày)
          example: 15
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      banner:
                        type: object
                        properties:
                          title:
                            type: string
                            example: "Phim mới ra mắt"
                          type:
                            type: string
                            example: "banner_list"
                          movies:
                            type: array
                            items:
                              $ref: "#/components/schemas/BannerMovie"
                      recommended:
                        type: object
                        properties:
                          title:
                            type: string
                            example: "Phim dành cho bạn"
                          type:
                            type: string
                            example: "grid"
                          movies:
                            type: array
                            items:
                              $ref: "#/components/schemas/GridMovie"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/home/continue-watching:
    get:
      tags:
        - Home
      summary: API Đang xem (Cần userId sẽ phát triển trong tương lai)
      description: |
        Lấy danh sách phim đang xem của user.

        **🔄 THAY ĐỔI:** Cần truyền userId qua query params thay vì Bearer token
      parameters:
        - name: userId
          in: query
          required: true
          schema:
            type: string
          example: "683d7b63d0ee4aeb15a11369"
          description: "ID của user cần lấy danh sách đang xem"
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
          example: 8
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Đang xem"
                      type:
                        type: string
                        example: "continue_watching"
                      data:
                        type: array
                        items:
                          type: object
                          properties:
                            movieId:
                              type: string
                              example: "60d5ecb74df5e2001f8b4567"
                            title:
                              type: string
                              example: "Avatar"
                            poster:
                              type: string
                              example: "https://example.com/poster.jpg"
                            progress:
                              type: number
                              example: 0.65
                            lastWatchedAt:
                              type: string
                              format: date-time
                              example: "2023-12-01T10:30:00Z"
        "400":
          description: Thiếu userId
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "userId là bắt buộc"

  /api/home/trending:
    get:
      tags:
        - Home
      summary: API Phim đang thịnh hành
      description: |
        Lấy danh sách phim đang thịnh hành (được xem nhiều nhất).

        **Đặc điểm:**
        - Public API (không cần đăng nhập)
        - Sắp xếp theo view count
        - Format giống GridMovie
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 7
            minimum: 1
            maximum: 20
          description: Số lượng phim trending (mặc định 7)
          example: 7
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Phim đang thịnh hành"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/home/top-rated:
    get:
      tags:
        - Home
      summary: API Phim được đánh giá cao
      description: |
        Lấy danh sách phim được đánh giá cao nhất.

        **Đặc điểm:**
        - Public API (không cần đăng nhập)
        - Sắp xếp theo rating
        - Chỉ lấy phim có rating > 0
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
            minimum: 1
            maximum: 20
          description: Số lượng phim top-rated (mặc định 8)
          example: 8
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Phim được đánh giá cao"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/home/sports:
    get:
      tags:
        - Home
      summary: API Sự kiện thể thao
      description: |
        Lấy danh sách sự kiện thể thao.

        **Đặc điểm:**
        - Public API (không cần đăng nhập)
        - Chỉ lấy movie_type = "Thể thao"
        - Filter theo status (upcoming, released, ended)
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
            minimum: 1
            maximum: 20
          description: Số lượng sự kiện thể thao (mặc định 8)
          example: 8
        - name: status
          in: query
          required: false
          schema:
            type: string
            enum: [upcoming, released, ended]
          description: |
            Filter theo trạng thái sự kiện:
            - upcoming: Sự kiện sắp diễn ra
            - released: Sự kiện đã phát hành (mặc định)
            - ended: Sự kiện đã kết thúc
          example: released
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Sự kiện thể thao"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/home/anime:
    get:
      tags:
        - Home
      summary: API Anime/Hoạt hình hot
      description: |
        Lấy danh sách anime/hoạt hình nổi bật với logic đặc trưng.
        **Fontend sử dụng cho:**
        - Section "Anime hot"
        - Grid layout hoạt hình
        - Hiển thị poster anime với tỉ lệ đặc biệt
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
            minimum: 1
            maximum: 20
          description: Số lượng anime hot (mặc định 8)
          example: 8
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Anime hot"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
              example:
                status: "success"
                data:
                  title: "Anime hot"
                  type: "grid"
                  movies: []
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi khi lấy anime hot"

  /api/home/vietnamese:
    get:
      tags:
        - Home
      summary: API Phim Việt đặc sắc
      description: |
        Lấy danh sách phim Việt Nam với logic tìm kiếm đặc trưng.

        **Logic đặc trưng:**
        - Sắp xếp theo rating (phim có rating cao nhất)
        - Tính toán rating/viewCount        
        **Fontend sử dụng cho:**
        - Section "Phim Việt đặc sắc"
        - Grid layout phim Việt
        - Hiển thị poster phim Việt Nam
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
            minimum: 1
            maximum: 20
          description: Số lượng phim Việt (mặc định 8)
          example: 8
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Phim Việt đặc sắc"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
              example:
                status: "success"
                data:
                  title: "Phim Việt đặc sắc"
                  type: "grid"
                  movies:
                    - movieId: "683fb55d88e880e019875aa7"
                      title: "Mình Yêu Nhau, Bình Yên Thôi"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/minh-yeu-nhau-binh-yen-thoi.jpg"
                      movieType: "Phim bộ"
                      producer: "SK Pictures, VTV3"
                    - movieId: "683e6774602b36157f1c7b18"
                      title: "Gặp Lại Chị Bầu"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/hai/gap-lai-chi-bau-500_1707203931098.jpg"
                      movieType: "Phim lẻ"
                      producer: "CJ Entertainment Vietnam"
                    - movieId: "683fb6e188e880e019875ac3"
                      title: "Ngày Xưa Có Một Chuyện Tình"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/ngay-xua-co-cau-chuyen-tinh.jpg"
                      movieType: "Phim lẻ"
                      producer: "HK Film, Hãng phim Anh Tễu"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi khi lấy phim Việt"

  /api/home/coming-soon:
    get:
      tags:
        - Home
      summary: API Phim sắp chiếu (đặt lịch sẽ phát triển trong tương lai)
      description: |
        Lấy danh sách phim sắp chiếu với logic đặc trưng.
        **Fontend sử dụng cho:**
        - Section "Sắp chiếu"
        - Grid layout phim sắp chiếu
        - Hiển thị poster + thông tin cơ bản
        - Có thể thêm countdown timer đến ngày chiếu
      parameters:
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 8
            minimum: 1
            maximum: 20
          description: Số lượng phim sắp chiếu (mặc định 8)
          example: 8
        - name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: Lấy phim sắp chiếu trong X ngày tới (mặc định 30 ngày)
          example: 15
      responses:
        "200":
          description: Lấy dữ liệu thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Sắp chiếu"
                      type:
                        type: string
                        example: "grid"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
              example:
                status: "success"
                data:
                  title: "Sắp chiếu"
                  type: "grid"
                  movies:
                    - movieId: "683fb76c88e880e019875acb"
                      title: "Avatar: The Way of Water 2"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/hanh-dong/avatar-way-of-water-2.jpg"
                      movieType: "Phim lẻ"
                      producer: "20th Century Studios"
                    - movieId: "683e922d88e880e019875a1f"
                      title: "World Cup 2026 Final"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/sports/world-cup-2026.jpg"
                      movieType: "Thể thao"
                      producer: "FIFA"
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi khi lấy phim sắp chiếu"

  # === SERIES/PHIM BỘ APIs ===
  /api/series/banner-series:
    get:
      tags:
        - Series
      summary: 🎬 API Banner và phim bộ đề xuất cho màn hình Series
      description: |
        **🎯 API CHUYÊN DÀNH CHO MÀN HÌNH PHIM BỘ**

        **📺 Trả về 2 sections:**
        - ✅ **Banner:** Phim bộ mới ra mắt (slider/banner)
        - ✅ **Grid:** Phim bộ đề xuất dành cho bạn

        **🔧 Đặc điểm:**
        - Chỉ lấy phim có `movie_type = "Phim bộ"`
        - Filter theo `release_status = "released"`
        - Sắp xếp theo ngày tạo mới nhất
        - Tự động format cho frontend FlatList/Grid

        **📱 Frontend Usage:**
        ```javascript
        // Lấy banner + grid cho màn hình phim bộ
        fetch('/api/series/banner-series')
        
        // Với custom parameters
        fetch('/api/series/banner-series?bannerLimit=3&limit=8&days=15')
        ```

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: bannerLimit
          in: query
          required: false
          schema:
            type: integer
            default: 5
            minimum: 1
            maximum: 10
          description: |
            **🎬 SỐ PHIM TRONG BANNER (Tùy chọn)**
            
            Số lượng phim bộ hiển thị trong banner slider
            - Mặc định: `5` phim ⭐ **Khuyên dùng**
            - Tối đa: `10` phim
          example: 5
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 6
            minimum: 1
            maximum: 20
          description: |
            **📊 SỐ PHIM TRONG GRID (Tùy chọn)**
            
            Số lượng phim bộ trong section "Phim bộ dành cho bạn"
            - Mặc định: `6` phim ⭐ **Khuyên dùng**
            - Tối đa: `20` phim
          example: 6
        - name: days
          in: query
          required: false
          schema:
            type: integer
            default: 30
            minimum: 1
            maximum: 365
          description: |
            **📅 LỌOC PHIM BỘ MỚI (Tùy chọn)**
            
            Lấy phim bộ mới trong X ngày gần đây
            - Mặc định: `30` ngày ⭐ **Khuyên dùng**
            - Tối đa: `365` ngày
          example: 30
      responses:
        "200":
          description: ✅ Lấy banner và phim bộ đề xuất thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      banner:
                        type: object
                        properties:
                          title:
                            type: string
                            example: "Phim bộ mới ra mắt"
                          type:
                            type: string
                            example: "banner_list"
                          movies:
                            type: array
                            items:
                              $ref: "#/components/schemas/BannerMovie"
                      recommended:
                        type: object
                        properties:
                          title:
                            type: string
                            example: "Phim bộ dành cho bạn"
                          type:
                            type: string
                            example: "grid"
                          movies:
                            type: array
                            items:
                              $ref: "#/components/schemas/GridMovie"
              example:
                status: "success"
                data:
                  banner:
                    title: "Phim bộ mới ra mắt"
                    type: "banner_list"
                    movies:
                      - movieId: "683fb76c88e880e019875aca"
                        title: "1000 Years Old"
                        poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
                        description: "Bộ phim tình cảm đặc sắc từ Thái Lan với câu chuyện tình yêu vượt thời gian..."
                        releaseYear: 2024
                        movieType: "Phim bộ"
                        producer: "WeTV Thailand"
                        genres: ["Tình cảm", "Drama"]
                  recommended:
                    title: "Phim bộ dành cho bạn"
                    type: "grid"
                    movies:
                      - movieId: "683fb76c88e880e019875aca"
                        title: "1000 Years Old"
                        poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
                        movieType: "Phim bộ"
                        producer: "WeTV Thailand"
        "500":
          description: ❌ Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi khi lấy banner phim bộ"

  /api/series/trending:
    get:
      tags:
        - Series
      summary: 🔥 API Phim bộ đang thịnh hành
      description: |
        **🎯 API PHIM BỘ HOT NHẤT**

        **🔥 Đặc điểm:**
        - Chỉ lấy phim có `movie_type = "Phim bộ"`
        - Sắp xếp theo lượt xem (view_count) cao nhất
        - Hỗ trợ xem tất cả với `showAll=true`
        - Tự động tính toán rating và stats

        **📱 Frontend Usage:**
        ```javascript
        // Lấy 8 phim bộ hot nhất
        fetch('/api/series/trending')
        
        // Xem tất cả phim bộ thịnh hành
        fetch('/api/series/trending?showAll=true')
        ```

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: showAll
          in: query
          required: false
          schema:
            type: string
            enum: ["true", "false"]
          description: |
            **👀 XEM TẤT CẢ (Tùy chọn)**
            
            - `true`: Xem tất cả phim bộ thịnh hành (pagination)
            - `false` hoặc không truyền: Chỉ 8 phim top
            
            💡 **Tip:** Dùng cho trang "Xem tất cả"
          example: "false"
      responses:
        "200":
          description: ✅ Lấy phim bộ thịnh hành thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Phim bộ đang thịnh hành"
                      type:
                        type: string
                        example: "grid"
                      showAll:
                        type: boolean
                        example: false
                      total:
                        type: integer
                        example: 8
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
              examples:
                default_view:
                  summary: "Xem mặc định (8 phim bộ top)"
                  value:
                    status: "success"
                    data:
                      title: "Phim bộ đang thịnh hành"
                      type: "grid"
                      showAll: false
                      total: 8
                      movies:
                        - movieId: "683fb76c88e880e019875aca"
                          title: "1000 Years Old"
                          poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
                          movieType: "Phim bộ"
                          producer: "WeTV Thailand"
                show_all_view:
                  summary: "Xem tất cả phim bộ thịnh hành"
                  value:
                    status: "success"
                    data:
                      title: "Tất cả phim bộ thịnh hành"
                      type: "grid"
                      showAll: true
                      total: 45
                      movies:
                        - movieId: "683fb76c88e880e019875aca"
                          title: "1000 Years Old"
                          poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
                          movieType: "Phim bộ"
                          producer: "WeTV Thailand"

  /api/series/vietnamese:
    get:
      tags:
        - Series
      summary: 🇻🇳 API Phim bộ Việt Nam
      description: |
        **🎯 API PHIM BỘ VIỆT NAM ĐẶC SẮC**

        **🇻🇳 Đặc điểm:**
        - Chỉ lấy phim có `movie_type = "Phim bộ"`
        - Filter producer chứa "Việt Nam" hoặc "Vietnam"
        - Sắp xếp theo đánh giá và lượt xem
        - Hỗ trợ xem tất cả với `showAll=true`

        **📱 Frontend Usage:**
        ```javascript
        // Lấy 8 phim bộ Việt hot nhất
        fetch('/api/series/vietnamese')
        
        // Xem tất cả phim bộ Việt
        fetch('/api/series/vietnamese?showAll=true')
        ```

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: showAll
          in: query
          required: false
          schema:
            type: string
            enum: ["true", "false"]
          description: |
            **👀 XEM TẤT CẢ PHIM BỘ VIỆT (Tùy chọn)**
            
            - `true`: Xem tất cả phim bộ Việt Nam
            - `false` hoặc không truyền: Chỉ 8 phim top
          example: "false"
      responses:
        "200":
          description: ✅ Lấy phim bộ Việt Nam thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Phim bộ Việt đặc sắc"
                      type:
                        type: string
                        example: "grid"
                      showAll:
                        type: boolean
                        example: false
                      total:
                        type: integer
                        example: 8
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"

  /api/series/anime:
    get:
      tags:
        - Series
      summary: 🎌 API Phim bộ Anime/Hoạt hình
      description: |
        **🎯 API ANIME SERIES HOT**

        **🎌 Đặc điểm:**
        - Chỉ lấy phim có `movie_type = "Phim bộ"`
        - Filter theo thể loại "Hoạt hình" hoặc producer anime
        - Sắp xếp theo popularity và rating
        - Hỗ trợ xem tất cả với `showAll=true`

        **📱 Frontend Usage:**
        ```javascript
        // Lấy 8 anime series hot nhất
        fetch('/api/series/anime')
        
        // Xem tất cả anime series
        fetch('/api/series/anime?showAll=true')
        ```

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: showAll
          in: query
          required: false
          schema:
            type: string
            enum: ["true", "false"]
          description: |
            **👀 XEM TẤT CẢ ANIME SERIES (Tùy chọn)**
            
            - `true`: Xem tất cả anime/hoạt hình bộ
            - `false` hoặc không truyền: Chỉ 8 series top
          example: "false"
      responses:
        "200":
          description: ✅ Lấy anime series thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "Anime series hot"
                      type:
                        type: string
                        example: "grid"
                      showAll:
                        type: boolean
                        example: false
                      total:
                        type: integer
                        example: 8
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"

  /api/series/korean:
    get:
      tags:
        - Series
      summary: 🇰🇷 API Phim bộ Hàn Quốc (K-Drama)
      description: |
        **🎯 API K-DRAMA HOT NHẤT**

        **🇰🇷 Đặc điểm:**
        - Chỉ lấy phim có `movie_type = "Phim bộ"`
        - Filter producer chứa "Hàn Quốc", "Korea", "KBS", "SBS", "MBC"
        - Sắp xếp theo popularity và rating
        - Hỗ trợ xem tất cả với `showAll=true`

        **📱 Frontend Usage:**
        ```javascript
        // Lấy 8 K-drama hot nhất
        fetch('/api/series/korean')
        
        // Xem tất cả K-drama
        fetch('/api/series/korean?showAll=true')
        ```

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: showAll
          in: query
          required: false
          schema:
            type: string
            enum: ["true", "false"]
          description: |
            **👀 XEM TẤT CẢ K-DRAMA (Tùy chọn)**
            
            - `true`: Xem tất cả phim bộ Hàn Quốc
            - `false` hoặc không truyền: Chỉ 8 phim top
          example: "false"
      responses:
        "200":
          description: ✅ Lấy K-drama thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      title:
                        type: string
                        example: "K-Drama hot nhất"
                      type:
                        type: string
                        example: "grid"
                      showAll:
                        type: boolean
                        example: false
                      total:
                        type: integer
                        example: 8
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
              example:
                status: "success"
                data:
                  title: "K-Drama hot nhất"
                  type: "grid"
                  showAll: false
                  total: 8
                  movies:
                    - movieId: "683fb123456789abcdef1234"
                      title: "Hometown's Embrace"
                      poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/korean/hometown-embrace.jpg"
                      movieType: "Phim bộ"
                      producer: "KBS Drama"

  # === MOVIE DETAIL API ===
  /api/movies/{id}/detail-with-interactions:
    get:
      tags:
        - Movie
      summary: 🎬 API Chi tiết phim tổng hợp cho màn hình detail
      description: |
        **🎯 Mục đích:** API tổng hợp mọi thông tin cần thiết cho màn hình chi tiết phim.

        **🌟 Đặc điểm:**
        - ✅ API hybrid: Public (không cần userId) hoặc Protected (có userId)
        - ✅ Không có userId: Chỉ thông tin phim + stats + comments
        - ✅ Có userId: Thêm user interactions (like, favorite, watching progress)
        - ✅ Trả về cấu hình tabs cho UI (Danh sách/Liên quan)
        - ✅ Thông tin khác nhau cho phim lẻ vs phim bộ

        **💡 Use Cases:**
        - Màn hình chi tiết phim (user chưa đăng nhập)
        - Màn hình chi tiết phim (user đã đăng nhập) - có trạng thái tương tác
        - UI render tabs dựa vào `tabs` config

        **🔄 THAY ĐỔI:** Sử dụng userId thay vì Authorization header
      parameters:
        - name: id
          in: query
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim (ObjectId)"
        - name: userId
          in: query
          schema:
            type: string
          example: "683d7b63d0ee4aeb15a11369"
          description: "ID của user (tùy chọn) - có userId thì trả về user interactions"
      responses:
        "200":
          description: ✅ Lấy chi tiết phim thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    $ref: "#/components/schemas/MovieDetailResponse"
              examples:
                phim_bo_with_user:
                  summary: "Phim bộ - Có userId (đăng nhập)"
                  value:
                    status: "success"
                    data:
                      movie:
                        _id: "675a1234567890abcdef1234"
                        movie_title: "Hồ Sơ Trinh Sát II - Tập 1"
                        description: "Bộ phim trinh thám Hong Kong nổi tiếng..."
                        production_time: "1995-12-15T00:00:00.000Z"
                        producer: "TVB Hong Kong"
                        poster_path: "https://example.com/poster.jpg"
                        genres:
                          - _id: "genre1"
                            genre_name: "Trinh thám"
                            description: "Phim trinh thám"
                        movie_type: "Phim bộ"
                        price: 0
                        is_free: true
                        price_display: "Miễn phí"
                        episodes:
                          - _id: "ep1"
                            episode_number: 1
                            episode_title: "Tập 1"
                            episode_description: "Tập mở đầu"
                            duration: 45
                            uri: "https://cdn.example.com/episode1.m3u8"
                            is_locked: false
                      stats:
                        views: 15420
                        viewsFormatted: "15.4K"
                        likes: 892
                        rating: 4.6
                        totalRatings: 1250
                        comments: 156
                      recentComments:
                        - _id: "comment1"
                          user:
                            name: "Bình Luận"
                            email: "user@example.com"
                          comment: "2 sép nên độc thân là ok nhất"
                          isLike: true
                          createdAt: "2024-12-11T12:00:00.000Z"
                      userInteractions:
                        hasLiked: true
                        hasRated: true
                        userComment: "Phim hay quá!"
                        isFavorite: true
                        isFollowing: true
                        watchingProgress:
                          episodeNumber: 1
                          watchPercentage: 75.5
                          currentTime: 2040
                          lastWatched: "2024-12-11T10:30:00.000Z"
                      relatedMovies:
                        - movieId: "675a1234567890abcdef5678"
                          title: "Hồ Sơ Trinh Sát I"
                          poster: "https://example.com/related1.jpg"
                          movieType: "Phim bộ"
                          producer: "TVB Hong Kong"
                      tabs:
                        showEpisodesList: true
                        showRelated: true
                phim_le_no_user:
                  summary: "Phim lẻ - Không có userId (chưa đăng nhập)"
                  value:
                    status: "success"
                    data:
                      movie:
                        _id: "675a1234567890abcdef9999"
                        movie_title: "Spider-Man: No Way Home"
                        description: "Bộ phim siêu anh hùng..."
                        production_time: "2021-12-15T00:00:00.000Z"
                        producer: "Sony Pictures"
                        poster_path: "https://example.com/spiderman.jpg"
                        genres:
                          - _id: "genre2"
                            genre_name: "Hành động"
                            description: "Phim hành động"
                        movie_type: "Phim lẻ"
                        price: 50000
                        is_free: false
                        price_display: "50,000 VNĐ"
                        uri: null
                        duration: 148
                        is_locked: true
                      stats:
                        views: 125340
                        viewsFormatted: "125K"
                        likes: 8934
                        rating: 4.8
                        totalRatings: 12450
                        comments: 2156
                      recentComments: []
                      userInteractions: null
                      relatedMovies: []
                      tabs:
                        showEpisodesList: false
                        showRelated: true
        "404":
          description: ❌ Không tìm thấy phim
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Không tìm thấy phim"
        "500":
          description: ❌ Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi khi lấy chi tiết phim"

  # === GENRE APIs ===
  /api/genres:
    get:
      tags:
        - Genre
      summary: Lấy danh sách thể loại
      description: |
        Lấy danh sách thể loại với nhiều options.
        
        **Query Parameters:**
        - `type`: Loại thể loại cần lấy ('all' | 'parent' | 'active' | 'children', mặc định: 'all')
        - `parent_id`: ID thể loại cha (chỉ dùng khi type='children')
        
        **Lưu ý:**
        - Luôn trả về poster (include_poster=true)
        - Luôn trả về dạng cây (format=tree)
        
        **Ví dụ:**
        1. Lấy tất cả thể loại:
           GET /api/genres
        2. Lấy thể loại cha:
           GET /api/genres?type=parent
        3. Lấy thể loại con của một thể loại cha:
           GET /api/genres?type=children&parent_id=123
      parameters:
        - in: query
          name: type
          schema:
            type: string
            enum: [all, parent, active, children]
            default: all
          description: Loại thể loại cần lấy
        - in: query
          name: parent_id
          schema:
            type: string
          description: ID thể loại cha (chỉ dùng khi type='children')
      responses:
        "200":
          description: Thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      genres:
                        type: array
                        items:
                          $ref: "#/components/schemas/Genre"
                      total:
                        type: integer
                        example: 10
                      type:
                        type: string
                        example: "all"
                      format:
                        type: string
                        example: "tree"
        "404":
          description: Không tìm thấy thể loại
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/genres/{genreId}/movies:
    get:
      tags:
        - Genre
      summary: Lấy danh sách phim của thể loại
      description: Lấy danh sách phim thuộc một thể loại cụ thể
      parameters:
        - in: query
          name: genreId
          required: true
          schema:
            type: string
          description: ID thể loại
      responses:
        "200":
          description: Thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      genre:
                        $ref: "#/components/schemas/Genre"
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/GridMovie"
                      total:  
                        type: integer
                        example: 10

  /api/genres/{id}:
    put:
      tags:
        - Genre
      summary: Cập nhật thể loại
      description: Cập nhật thông tin của một thể loại
      parameters:
        - in: query
          name: id
          required: true
          schema:
            type: string
          description: ID thể loại
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                genre_name:
                  type: string
                  example: "Hành động"
                description:
                  type: string
                  example: "Phim hành động gay cấn"
                poster:
                  type: string
                  example: "https://example.com/poster.jpg"
                sort_order:
                  type: integer
                  example: 1
      responses:
        "200":
          description: Cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã cập nhật thể loại thành công"
                  data:
                    type: object
                    properties:
                      genre:
                        $ref: "#/components/schemas/Genre"
    delete:
      tags:
        - Genre
      summary: Xóa thể loại
      description: Xóa một thể loại
      parameters:
        - in: query
          name: id
          required: true
          schema:
            type: string
          description: ID thể loại
      responses:
        "200":
          description: Xóa thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã xóa thể loại thành công"

  /api/genres/{id}/status:
    put:
      tags:
        - Genre
      summary: Cập nhật trạng thái thể loại
      description: |
        Cập nhật trạng thái của thể loại (activate/deactivate/toggle).
        
        **Lưu ý:**
        - Nếu không truyền action → Toggle trạng thái
        - Nếu truyền action → Set trạng thái theo action
      parameters:
        - in: query
          name: id
          required: true
          schema:
            type: string
          description: ID thể loại
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                action:
                  type: string
                  enum: [activate, deactivate]
                  example: "activate"
      responses:
        "200":
          description: Cập nhật thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã cập nhật trạng thái thể loại thành công"
                  data:
                    type: object
                    properties:
                      genre:
                        $ref: "#/components/schemas/Genre"

  # === MOVIE INTERACTION APIs ===
  /api/ratings/movies/{movie_id}/like:
    post:
      tags:
        - Movie Interactions
      summary: ❤️ Thích phim
      description: |
        **🎯 Mục đích:** User thích một bộ phim.

        **🔄 THAY ĐỔI:** Sử dụng userId trong body thay vì Authorization header
      parameters:
        - name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: "683d7b63d0ee4aeb15a11369"
                  description: "ID của user thực hiện thao tác"
      responses:
        "200":
          description: ✅ Thích phim thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã thích phim thành công"
                  data:
                    type: object
                    properties:
                      movieId:
                        type: string
                        example: "675a1234567890abcdef1234"
                      likeCount:
                        type: integer
                        example: 893
                      rating:
                        type: number
                        format: float
                        example: 4.6
        "404":
          description: ❌ Không tìm thấy phim
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/ratings/movies/{movie_id}/unlike:
    post:
      tags:
        - Movie Interactions
      summary: 💔 Bỏ thích phim
      description: |
        **🎯 Mục đích:** User bỏ thích một bộ phim.

        **🔄 THAY ĐỔI:** Sử dụng userId trong body thay vì Authorization header
      parameters:
        - name: movie_id
          in: query             
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: "683d7b63d0ee4aeb15a11369"
                  description: "ID của user thực hiện thao tác"
      responses:
        "200":
          description: ✅ Bỏ thích phim thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã bỏ thích phim thành công"
                  data:
                    type: object
                    properties:
                      movieId:
                        type: string
                        example: "675a1234567890abcdef1234"
                      likeCount:
                        type: integer
                        example: 891
                      rating:
                        type: number
                        format: float
                        example: 4.5

  /api/ratings/movies/{movie_id}/comment:
    post:
      tags:
        - Movie Interactions
      summary: 💬 Thêm bình luận phim
      description: |
        **🎯 Mục đích:** User thêm bình luận cho một bộ phim.

        **🔄 THAY ĐỔI:** Sử dụng userId trong body thay vì Authorization header
      parameters:
        - name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
                - comment
              properties:
                userId:
                  type: string
                  example: "683d7b63d0ee4aeb15a11369"
                  description: "ID của user thực hiện thao tác"
                comment:
                  type: string
                  example: "Phim hay quá! Diễn viên diễn rất tự nhiên."
                  description: "Nội dung bình luận"
      responses:
        "200":
          description: ✅ Thêm bình luận thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã thêm bình luận thành công"
                  data:
                    type: object
                    properties:
                      movieId:
                        type: string
                        example: "675a1234567890abcdef1234"
                      comment:
                        type: object
                        properties:
                          id:
                            type: string
                            example: "rating123"
                          comment:
                            type: string
                            example: "Phim hay quá! Diễn viên diễn rất tự nhiên."
                          user:
                            $ref: "#/components/schemas/UserInfo"
                          createdAt:
                            type: string
                            format: date-time
                            example: "2024-12-11T12:00:00.000Z"
        "400":
          description: ❌ Bình luận không được để trống
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"

  /api/favorites/movies/{movie_id}/add:
    post:
      tags:
        - Movie Interactions
      summary: ⭐ Thêm vào danh sách yêu thích
      description: |
        **🎯 Mục đích:** User thêm phim vào danh sách yêu thích.

        **🔄 THAY ĐỔI:** Sử dụng userId trong body thay vì Authorization header
      parameters:
        - name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: "683d7b63d0ee4aeb15a11369"
                  description: "ID của user thực hiện thao tác"
      responses:
        "200":
          description: ✅ Thêm vào yêu thích thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã thêm vào danh sách yêu thích"

  /api/favorites/movies/{movie_id}/remove:
    post:
      tags:
        - Movie Interactions
      summary: ❌ Xóa khỏi danh sách yêu thích
      description: |
        **🎯 Mục đích:** User xóa phim khỏi danh sách yêu thích.

        **🔄 THAY ĐỔI:** Sử dụng userId trong body thay vì Authorization header
      parameters:
        - name: movie_id
          in: query
          required: true
          schema:
            type: string
          example: "675a1234567890abcdef1234"
          description: "ID của phim"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - userId
              properties:
                userId:
                  type: string
                  example: "683d7b63d0ee4aeb15a11369"
                  description: "ID của user thực hiện thao tác"
      responses:
        "200":
          description: ✅ Xóa khỏi yêu thích thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  message:
                    type: string
                    example: "Đã xóa khỏi danh sách yêu thích"

  /api/movies/search:
    get:
      tags:
        - Movie
      summary: 🔍 Tìm kiếm phim đơn giản theo tên và mô tả
      description: |
        **🎯 API TÌM KIẾM PHIM ĐƠN GIẢN**

        **📚 CÁCH DÙNG ĐỚN GIẢN NHẤT:**
        ```javascript
        // 1. Tìm tất cả phim (không cần tham số)
        GET /api/movies/search
        
        // 2. Tìm theo từ khóa trong tên và mô tả
        GET /api/movies/search?tuKhoa=avatar
        
        // 3. Lấy thêm phim (pagination)
        GET /api/movies/search?page=2&limit=20
        ```

        **🔧 TÍNH NĂNG:**
        - ✅ **Tìm kiếm đơn giản:** CHỈ trong tên phim và mô tả
        - ✅ **Pagination tự động:** hỗ trợ infinite scroll
        - ✅ **Response tối ưu:** poster, stats, pricing info
        - ✅ **Sắp xếp mặc định:** theo ngày tạo mới nhất

        **📱 FRONTEND EXAMPLES:**
        ```javascript
        // Tìm kiếm cơ bản
        fetch('/api/movies/search?tuKhoa=batman')
        
        // Load more cho FlatList
        fetch('/api/movies/search?tuKhoa=batman&page=2&limit=20')
        
        // Lấy tất cả phim
        fetch('/api/movies/search?page=1&limit=20')
        ```

        **🎯 PERFECT FOR:**
        - Search screens với FlatList/Grid
        - Simple movie search
        - Infinite scroll implementation

        **🔓 Public API** (không cần đăng nhập)
      parameters:
        - name: tuKhoa
          in: query
          required: false
          schema:
            type: string
          description: |
            **🔤 TỪ KHÓA TÌM KIẾM (Tùy chọn)**
            
            Tìm kiếm đơn giản chỉ trong:
            - 🎬 Tên phim 
            - 📝 Mô tả phim
            
            💡 **Tips:** Không phân biệt hoa thường, có thể tìm tiếng Việt có dấu
          example: "batman"
        - name: page
          in: query
          required: false
          schema:
            type: integer
            default: 1
            minimum: 1
          description: |
            **📄 TRANG HIỆN TẠI (Tùy chọn)**
            
            Dùng cho infinite scroll trong FlatList
            - Trang đầu: `1` (mặc định)
            - Load more: `2`, `3`, `4`...
          example: 1
        - name: limit
          in: query
          required: false
          schema:
            type: integer
            default: 20
            minimum: 1
            maximum: 100
          description: |
            **📊 SỐ PHIM MỖI TRANG (Tùy chọn)**
            
            - Mặc định: `20` phim ⭐ **Khuyên dùng**
            - Tối thiểu: `1` phim
            - Tối đa: `100` phim
            
            💡 **FlatList tip:** Dùng 20 cho performance tốt
          example: 20
      responses:
        "200":
          description: ✅ Tìm kiếm phim thành công
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                    example: "success"
                  data:
                    type: object
                    properties:
                      movies:
                        type: array
                        items:
                          $ref: "#/components/schemas/SearchMovieResult"
                      pagination:
                        $ref: "#/components/schemas/PaginationInfo"
                      search_info:
                        $ref: "#/components/schemas/SearchInfo"
              examples:
                basic_search:
                  summary: "Tìm kiếm cơ bản với pagination"
                  value:
                    status: "success"
                    data:
                      movies:
                        - movieId: "683fb76c88e880e019875aca"
                          title: "1000 Years Old"
                          poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
                          movieType: "Phim bộ"
                          producer: "WeTV Thailand"
                          description: "Bộ phim tình cảm đặc sắc từ Thái Lan với câu chuyện tình yêu vượt thời gian..."
                          releaseYear: 2024
                          price: 0
                          is_free: true
                          price_display: "Miễn phí"
                          view_count: 15420
                          favorite_count: 892
                          rating: 4.6
                          total_ratings: 1250
                          total_episodes: 12
                          genres: ["Tình cảm", "Drama"]
                        - movieId: "683fb76c88e880e019875acb"
                          title: "Avatar: The Way of Water 2"
                          poster: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/hanh-dong/avatar-way-of-water-2.jpg"
                          movieType: "Phim lẻ"
                          producer: "20th Century Studios"
                          description: "Phần tiếp theo đầy màu sắc của bom tấn Avatar với những cảnh quay dưới nước..."
                          releaseYear: 2025
                          price: 50000
                          is_free: false
                          price_display: "50,000 VNĐ"
                          view_count: 89342
                          favorite_count: 5234
                          rating: 4.8
                          total_ratings: 8934
                          total_episodes: 1
                          genres: ["Hành động", "Khoa học viễn tưởng", "Phiêu lưu"]
                      pagination:
                        current_page: 1
                        total_pages: 5
                        total_items: 89
                        items_per_page: 20
                        has_next: true
                        has_prev: false
                      search_info:
                        keyword: "avatar"
                        search_in: ["movie_title", "description"]
                        total_found: 89
                simple_search:
                  summary: "Tìm kiếm đơn giản"
                  value:
                    status: "success"
                    data:
                      movies:
                        - movieId: "683fb76c88e880e019875acc"
                          title: "Inception"
                          poster: "https://example.com/inception.jpg"
                          movieType: "Phim lẻ"
                          producer: "Warner Bros"
                          description: "Bộ phim khoa học viễn tưởng về giấc mơ và thực tại đan xen..."
                          releaseYear: 2010
                          price: 0
                          is_free: true
                          price_display: "Miễn phí"
                          view_count: 234567
                          favorite_count: 12345
                          rating: 4.9
                          total_ratings: 15678
                          total_episodes: 1
                          genres: ["Khoa học viễn tưởng", "Hành động"]
                      pagination:
                        current_page: 2
                        total_pages: 3
                        total_items: 42
                        items_per_page: 20
                        has_next: true
                        has_prev: true
                      search_info:
                        keyword: "dream"
                        search_in: ["movie_title", "description"]
                        total_found: 42
        "500":
          description: Lỗi server
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/ErrorResponse"
              example:
                status: "error"
                message: "Lỗi server khi tìm kiếm phim"

components:
  schemas:
    PhoneRequest:
      type: object
      required:
        - phone
      properties:
        phone:
          type: string
          example: "0912345678"
          description: |
            Số điện thoại của người dùng
            - Format: 0xxxxxxxxx hoặc +84xxxxxxxxx
            - Phải là số điện thoại Việt Nam hợp lệ
            - Không được chứa ký tự đặc biệt hoặc khoảng trắng

    VerifyOTPRequest:
      type: object
      required:
        - phone
        - otp
      properties:
        phone:
          type: string
          example: "0912345678"
          description: Số điện thoại đã dùng để nhận OTP
        otp:
          type: string
          example: "123456"
          description: Mã OTP 6 số nhận được qua SMS

    RegisterRequest:
      type: object
      required:
        - full_name
        - email
        - gender
      properties:
        full_name:
          type: string
          example: "Nguyễn Văn A"
          description: Họ và tên người dùng
        email:
          type: string
          format: email
          example: "example@gmail.com"
          description: Email người dùng (phải là email hợp lệ và chưa được sử dụng)
        gender:
          type: string
          enum: [male, female]
          example: "male"
          description: Giới tính (male = Nam, female = Nữ)

    UpdateProfileRequest:
      type: object
      description: "🔄 Schema for multipart/form-data profile update with avatar upload"
      properties:
        full_name:
          type: string
          example: "Đạt Thiện"
          description: "Họ và tên người dùng (có thể update)"
        gender:
          type: string
          enum: [male, female, other]
          example: "male"
          description: "Giới tính (male=Nam, female=Nữ, other=Khác) - có thể update"
        avatar:
          type: string
          format: binary
          description: "File ảnh đại diện (JPEG/PNG/GIF, max 2MB)"
      additionalProperties: false
      example:
        full_name: "Đạt Thiện Updated"
        gender: "male"
        avatar: "[BINARY_FILE_DATA]"

    UpdateProfileTextOnlyRequest:
      type: object
      description: "Schema for text-only profile update (no avatar)"
      properties:
        full_name:
          type: string
          example: "Đạt Thiện"
          description: "Họ và tên người dùng"
        gender:
          type: string
          enum: [male, female, other]
          example: "male"
          description: "Giới tính (male=Nam, female=Nữ, other=Khác)"
      additionalProperties: false

    AuthResponse:
      type: object
      properties:
        status:
          type: string
          example: "success"
        message:
          type: string
          example: "Đăng nhập thành công"
        data:
          type: object
          properties:
            userId:
              type: string
              example: "683d7b63d0ee4aeb15a11369"
              description: "⚠️ LƯU LẠI CÁI NÀY! Dùng cho tất cả APIs cần authentication"
            user:
              $ref: "#/components/schemas/UserInfo"
          description: "Không còn trả về tokens nữa, chỉ có userId và user info"

    ProfileResponse:
      type: object
      properties:
        status:
          type: string
          example: "success"
        message:
          type: string
          example: "Lấy thông tin thành công"
        data:
          type: object
          properties:
            user:
              $ref: "#/components/schemas/UserInfo"

    UserInfo:
      type: object
      properties:
        _id:
          type: string
          example: "683d7b63d0ee4aeb15a11369"
        uid:
          type: string
          example: "683d7b63d0ee4aeb15a11369"
          description: "UID để hiển thị trên màn hình (giống _id)"
        full_name:
          type: string
          example: "Nguyễn Văn A"
        email:
          type: string
          example: "example@gmail.com"
        phone:
          type: string
          example: "0912345678"
        gender:
          type: string
          enum: [male, female, other]
          example: "male"
          description: "Giới tính: male=Nam, female=Nữ, other=Khác"
        avatar:
          type: string
          example: "https://example.com/avatar.jpg"
        is_phone_verified:
          type: boolean
          example: true

    SuccessResponse:
      type: object
      properties:
        status:
          type: string
          example: "success"
        message:
          type: string

    ErrorResponse:
      type: object
      properties:
        status:
          type: string
          example: "error"
        message:
          type: string

    BannerMovie:
      type: object
      description: Schema cho phim trong banner section
      properties:
        movieId:
          type: string
          example: "683fb76c88e880e019875aca"
          description: ID của phim
        title:
          type: string
          example: "1000 Years Old"
          description: Tên phim
        poster:
          type: string
          example: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
          description: URL poster phim
        description:
          type: string
          nullable: true
          example: "Phim lẻ Việt Nam dựa trên truyện dài cùng tên của Nguyễn Nhật Ánh..."
          description: Mô tả phim (có thể null)
        releaseYear:
          type: integer
          nullable: true
          example: 2024
          description: Năm phát hành (có thể null)
        movieType:
          type: string
          example: "Phim bộ"
          description: Loại phim (Phim bộ, Phim lẻ, Thể thao)
        producer:
          type: string
          example: "WeTV Thailand"
          description: Nhà sản xuất
        genres:
          type: array
          items:
            type: string
          example: ["Tình cảm", "Kinh dị"]
          description: Danh sách thể loại (tối đa 3)

    # === GENRE SCHEMAS ===
    HomeCategoryItem:
      type: object
      description: Schema cho thể loại cha trong trang chủ
      properties:
        _id:
          type: string
          example: "6847d080101e640d01a0c37f"
          description: ID duy nhất của thể loại
        title:
          type: string
          example: "Hoạt hình"
          description: Tên thể loại hiển thị
        description:
          type: string
          example: "Phim hoạt hình, anime và phim động"
          description: Mô tả thể loại
        poster:
          type: string
          example: "https://images.unsplash.com/photo-1578662996442-48f60103fc96?w=400&h=300&fit=crop"
          description: URL hình ảnh poster cho thể loại
        movie_count:
          type: integer
          example: 9
          description: Tổng số phim thuộc thể loại (bao gồm cả con)
        has_children:
          type: boolean
          example: true
          description: Có thể loại con hay không
        children_count:
          type: integer
          example: 4
          description: Số lượng thể loại con
        sort_order:
          type: integer
          example: 1
          description: Thứ tự sắp xếp

    GenreInfo:
      type: object
      description: Schema thông tin cơ bản của thể loại
      properties:
        _id:
          type: string
          example: "6847d080101e640d01a0c37f"
          description: ID của thể loại
        genre_name:
          type: string
          example: "Hoạt hình"
          description: Tên thể loại
        description:
          type: string
          example: "Phim hoạt hình, anime và phim động"
          description: Mô tả thể loại

    ChildGenreItem:
      type: object
      description: Schema cho thể loại con
      properties:
        _id:
          type: string
          example: "683d7d1dd0ee4aeb15a1138c"
          description: ID của thể loại con
        genre_name:
          type: string
          example: "Hành Động"
          description: Tên thể loại con
        description:
          type: string
          example: "Phim hành động, võ thuật"
          description: Mô tả thể loại con
        movie_count:
          type: integer
          example: 24
          description: Số lượng phim thuộc thể loại con
        sort_order:
          type: integer
          example: 1
          description: Thứ tự sắp xếp

    GridMovie:
      type: object
      description: Schema cho phim trong grid section
      properties:
        movieId:
          type: string
          example: "683fb76c88e880e019875aca"
          description: ID của phim
        title:
          type: string
          example: "1000 Years Old"
          description: Tên phim
        poster:
          type: string
          example: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
          description: URL poster phim
        movieType:
          type: string
          example: "Phim bộ"
          description: Loại phim (Phim bộ, Phim lẻ, Thể thao)
        producer:
          type: string
          example: "WeTV Thailand"
          description: Nhà sản xuất

    # === MOVIE DETAIL SCHEMAS ===
    MovieDetailResponse:
      type: object
      description: Schema response chi tiết phim tổng hợp cho màn hình detail
      properties:
        movie:
          type: object
          description: Thông tin chi tiết phim
          properties:
            _id:
              type: string
              example: "675a1234567890abcdef1234"
            movie_title:
              type: string
              example: "Hồ Sơ Trinh Sát II - Tập 1"
            description:
              type: string
              example: "Bộ phim trinh thám Hong Kong nổi tiếng..."
            production_time:
              type: string
              format: date-time
              example: "1995-12-15T00:00:00.000Z"
            producer:
              type: string
              example: "TVB Hong Kong"
            poster_path:
              type: string
              example: "https://example.com/poster.jpg"
            genres:
              type: array
              items:
                type: object
                properties:
                  _id:
                    type: string
                  genre_name:
                    type: string
                  description:
                    type: string
            movie_type:
              type: string
              enum: ["Phim bộ", "Phim lẻ", "Thể thao"]
              example: "Phim bộ"
            price:
              type: number
              example: 0
            is_free:
              type: boolean
              example: true
            price_display:
              type: string
              example: "Miễn phí"
            episodes:
              type: array
              description: "Danh sách tập (chỉ có khi là phim bộ)"
              items:
                type: object
                properties:
                  _id:
                    type: string
                  episode_number:
                    type: integer
                  episode_title:
                    type: string
                  episode_description:
                    type: string
                  duration:
                    type: integer
                  uri:
                    type: string
                    nullable: true
                  is_locked:
                    type: boolean
            uri:
              type: string
              nullable: true
              description: "Video URL (chỉ có khi là phim lẻ)"
            duration:
              type: integer
              description: "Thời lượng phim lẻ (phút)"
            is_locked:
              type: boolean
              description: "Phim có bị khóa không"
        stats:
          type: object
          description: Thống kê phim
          properties:
            views:
              type: integer
              example: 15420
            viewsFormatted:
              type: string
              example: "15.4K"
            likes:
              type: integer
              example: 892
            rating:
              type: number
              format: float
              example: 4.6
            totalRatings:
              type: integer
              example: 1250
            comments:
              type: integer
              example: 156
        recentComments:
          type: array
          description: 5 bình luận gần đây nhất
          items:
            type: object
            properties:
              _id:
                type: string
              user:
                type: object
                properties:
                  name:
                    type: string
                  email:
                    type: string
              comment:
                type: string
              isLike:
                type: boolean
              createdAt:
                type: string
                format: date-time
        userInteractions:
          type: object
          nullable: true
          description: "Tương tác của user (null nếu chưa đăng nhập)"
          properties:
            hasLiked:
              type: boolean
              example: true
              description: "User đã like phim chưa"
            hasRated:
              type: boolean
              example: true
              description: "User đã rate phim chưa"
            userComment:
              type: string
              nullable: true
              example: "Phim hay quá!"
              description: "Bình luận của user"
            isFavorite:
              type: boolean
              example: true
              description: "Đã thêm vào yêu thích chưa"
            isFollowing:
              type: boolean
              example: true
              description: "Đã theo dõi phim chưa (giống isFavorite)"
            watchingProgress:
              type: object
              nullable: true
              description: "Tiến độ xem phim"
              properties:
                episodeNumber:
                  type: integer
                  example: 1
                watchPercentage:
                  type: number
                  example: 75.5
                currentTime:
                  type: integer
                  example: 2040
                lastWatched:
                  type: string
                  format: date-time
                  example: "2024-12-11T10:30:00.000Z"
        relatedMovies:
          type: array
          description: Phim liên quan cho tab "Liên quan"
          items:
            type: object
            properties:
              movieId:
                type: string
                example: "675a1234567890abcdef5678"
              title:
                type: string
                example: "Hồ Sơ Trinh Sát I"
              poster:
                type: string
                example: "https://example.com/related1.jpg"
              movieType:
                type: string
                example: "Phim bộ"
              producer:
                type: string
                example: "TVB Hong Kong"
        tabs:
          type: object
          description: Cấu hình tabs cho UI
          properties:
            showEpisodesList:
              type: boolean
              example: true
              description: "true = hiện tab 'Danh sách' (chỉ phim bộ có true)"
            showRelated:
              type: boolean
              example: true
              description: "true = hiện tab 'Liên quan' (luôn luôn true)"

    Genre:
      type: object
      properties:
        _id:
          type: string
          example: "683d7b63d0ee4aeb15a11369"
        genre_name:
          type: string
          example: "Hành động"
        description:
          type: string
          example: "Phim hành động gay cấn"
        poster:
          type: string
          example: "https://example.com/poster.jpg"
        parent_genre:
          type: string
          nullable: true
          example: "683d7b63d0ee4aeb15a11369"
        is_parent:
          type: boolean
          example: true
        is_active:
          type: boolean
          example: true
        sort_order:
          type: integer
          example: 1
        created_at:
          type: string
          format: date-time
        updated_at:
          type: string
          format: date-time

    # === SEARCH SCHEMAS ===
    SearchMovieResult:
      type: object
      description: "🔍 Schema phim tối ưu cho Search Results + FlatList"
      properties:
        movieId:
          type: string
          example: "683fb76c88e880e019875aca"
          description: "ID của phim"
        title:
          type: string
          example: "1000 Years Old"
          description: "Tên phim"
        poster:
          type: string
          nullable: true
          example: "https://locdev-bucket.s3.ap-southeast-1.amazonaws.com/assets/tinh-cam/phimbo-1000-years-old.jpg"
          description: "URL poster phim"
        movieType:
          type: string
          enum: ["Phim bộ", "Phim lẻ", "Thể thao"]
          example: "Phim bộ"
          description: "Loại phim"
        producer:
          type: string
          example: "WeTV Thailand"
          description: "Nhà sản xuất"
        description:
          type: string
          nullable: true
          example: "Bộ phim tình cảm đặc sắc từ Thái Lan với câu chuyện tình yêu vượt thời gian..."
          description: "Mô tả ngắn phim (100 ký tự)"
        releaseYear:
          type: integer
          nullable: true
          example: 2024
          description: "Năm phát hành"
        price:
          type: number
          example: 0
          description: "Giá phim (VNĐ)"
        is_free:
          type: boolean
          example: true
          description: "Phim miễn phí hay không"
        price_display:
          type: string
          example: "Miễn phí"
          description: "Hiển thị giá định dạng"
        view_count:
          type: integer
          example: 15420
          description: "Số lượt xem"
        favorite_count:
          type: integer
          example: 892
          description: "Số lượt yêu thích"
        rating:
          type: number
          format: float
          example: 4.6
          description: "Đánh giá trung bình (0-5)"
        total_ratings:
          type: integer
          example: 1250
          description: "Tổng số đánh giá"
        total_episodes:
          type: integer
          example: 12
          description: "Tổng số tập"
        genres:
          type: array
          items:
            type: string
          example: ["Tình cảm", "Drama"]
          description: "Danh sách thể loại (tối đa 3)"

    PaginationInfo:
      type: object
      description: "📄 Thông tin phân trang cho FlatList infinite scroll"
      properties:
        current_page:
          type: integer
          example: 1
          description: "Trang hiện tại"
        total_pages:
          type: integer
          example: 5
          description: "Tổng số trang"
        total_items:
          type: integer
          example: 89
          description: "Tổng số phim"
        items_per_page:
          type: integer
          example: 20
          description: "Số phim mỗi trang"
        has_next:
          type: boolean
          example: true
          description: "Có trang tiếp theo không"
        has_prev:
          type: boolean
          example: false
          description: "Có trang trước không"

    SearchInfo:
      type: object
      description: "🔍 Thông tin tìm kiếm và filter đã áp dụng"
      properties:
        keyword:
          type: string
          nullable: true
          example: "avatar"
          description: "Từ khóa tìm kiếm"
        filters:
          type: object
          properties:
            genre:
              type: string
              nullable: true
              example: "6847d080101e640d01a0c37f"
              description: "ID thể loại đã lọc"
            movie_type:
              type: string
              nullable: true
              example: "Phim lẻ"
              description: "Loại phim đã lọc"
            is_free:
              type: string
              nullable: true
              example: "true"
              description: "Filter miễn phí"
            sort:
              type: string
              example: "phobien"
              description: "Cách sắp xếp đã áp dụng"

